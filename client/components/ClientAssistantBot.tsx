import React, { useState, useRef, useEffect } from "react";
import { motion, AnimatePresence } from "framer-motion";
import {
  MessageCircle,
  X,
  Send,
  Bot,
  User,
  Phone,
  Mail,
  Clock,
  Star,
  MapPin,
  Globe,
  Smartphone,
  Calendar,
  Info,
  HelpCircle,
  ArrowRight,
  CheckCircle,
  Package,
  CreditCard,
  Headphones,
  ThumbsUp,
  Zap,
  Heart,
  Coffee,
  Rocket,
  Sparkles,
} from "lucide-react";
import { Button } from "./ui/button";
import { useAuth } from "../contexts/AuthContext";

interface ClientMessage {
  id: string;
  type: "bot" | "user";
  content: string;
  timestamp: Date;
  category?: "info" | "service" | "contact" | "help" | "pricing";
  quickReplies?: string[];
  actions?: Array<{
    label: string;
    action: () => void;
    icon?: React.ElementType;
    type?: "primary" | "secondary";
  }>;
}

export const ClientAssistantBot: React.FC = () => {
  const { isAdmin } = useAuth();
  const [isOpen, setIsOpen] = useState(false);
  const [messages, setMessages] = useState<ClientMessage[]>([]);
  const [currentMessage, setCurrentMessage] = useState("");
  const [isTyping, setIsTyping] = useState(false);
  const [showContactForm, setShowContactForm] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  useEffect(() => {
    if (isOpen && messages.length === 0) {
      const welcomeMessage: ClientMessage = {
        id: "welcome",
        type: "bot",
        content: `# Bonjour ! üëã Bienvenue chez Mind Graphix Solution

Je suis **MindiBot**, votre assistant personnel pour vous accompagner dans votre projet digital !

üéØ **Comment puis-je vous aider aujourd'hui ?**

‚Ä¢ **üìû Prendre un rendez-vous** pour discuter de votre projet
‚Ä¢ **üí∞ Obtenir un devis** personnalis√© et gratuit  
‚Ä¢ **üé® D√©couvrir nos services** (Web, Design, Marketing)
‚Ä¢ **üìã Voir nos r√©alisations** et t√©moignages clients
‚Ä¢ **‚ùì Poser vos questions** sur nos processus

**Mind Graphix Solution** - Votre partenaire digital au Burkina Faso depuis 2020 üáßüá´`,
        timestamp: new Date(),
        category: "info",
        quickReplies: [
          "üí∞ Demander un devis",
          "üìû Prendre rendez-vous",
          "üé® Voir vos services",
          "üìã Vos r√©alisations",
        ],
        actions: [
          {
            label: "Nos Services",
            action: () => showServices(),
            icon: Package,
            type: "primary",
          },
          {
            label: "Contact Direct",
            action: () => showContact(),
            icon: Phone,
            type: "secondary",
          },
        ],
      };
      setMessages([welcomeMessage]);
    }
  }, [isOpen]);

  const addBotMessage = (
    content: string,
    category: ClientMessage["category"] = "info",
    quickReplies?: string[],
    actions?: ClientMessage["actions"],
  ) => {
    setIsTyping(true);
    setTimeout(
      () => {
        const newMessage: ClientMessage = {
          id: `bot_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
          type: "bot",
          content,
          timestamp: new Date(),
          category,
          quickReplies,
          actions,
        };
        setMessages((prev) => [...prev, newMessage]);
        setIsTyping(false);
      },
      Math.random() * 1500 + 800,
    );
  };

  const addUserMessage = (content: string) => {
    const newMessage: ClientMessage = {
      id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
      type: "user",
      content,
      timestamp: new Date(),
    };
    setMessages((prev) => [...prev, newMessage]);
  };

  const analyzeClientQuery = (
    query: string,
  ): {
    response: string;
    category: ClientMessage["category"];
    quickReplies?: string[];
    actions?: ClientMessage["actions"];
  } => {
    const lowerQuery = query.toLowerCase();

    // Demande de devis
    if (
      lowerQuery.includes("devis") ||
      lowerQuery.includes("prix") ||
      lowerQuery.includes("co√ªt") ||
      lowerQuery.includes("tarif")
    ) {
      return {
        response: `# üí∞ Devis Personnalis√© Gratuit

Excellente question ! Nous proposons des **devis 100% gratuits** et personnalis√©s selon vos besoins.

## üéØ Nos Tarifs Indicatifs :

**üåê Sites Web**
‚Ä¢ **Site Vitrine** : √Ä partir de 262.000 FCFA
‚Ä¢ **Site E-commerce** : √Ä partir de 787.000 FCFA
‚Ä¢ **Application Web** : √Ä partir de 525.000 FCFA

**üé® Design Graphique**
‚Ä¢ **Identit√© Visuelle** : √Ä partir de 131.000 FCFA
‚Ä¢ **Supports Print** : √Ä partir de 52.500 FCFA
‚Ä¢ **Design Digital** : √Ä partir de 78.750 FCFA

**üìä Marketing Digital**
‚Ä¢ **Strat√©gie Compl√®te** : √Ä partir de 394.000 FCFA
‚Ä¢ **Gestion R√©seaux Sociaux** : √Ä partir de 131.000 FCFA
‚Ä¢ **SEO & R√©f√©rencement** : √Ä partir de 262.000 FCFA

## üìû **Prochaines √âtapes :**
1. **Consultation gratuite** (30min) pour analyser vos besoins
2. **Devis d√©taill√©** sous 48h maximum
3. **Proposition personnalis√©e** avec planning

Souhaitez-vous qu'on planifie un appel d√©couverte ?`,
        category: "pricing",
        quickReplies: [
          "üìû Planifier un appel",
          "üìß Recevoir le devis par email",
          "üí¨ Plus d'infos sur un service",
        ],
        actions: [
          {
            label: "Demander un Devis",
            action: () => setShowContactForm(true),
            icon: CreditCard,
            type: "primary",
          },
          {
            label: "Appeler Maintenant",
            action: () =>
              addBotMessage(
                "üìû **Contact Direct**\n\n**T√©l√©phone :** +226 54191605\n**Email :** contact@mindgraphix.com\n\nNous sommes disponibles du Lundi au Vendredi, 8h-18h.",
                "contact",
              ),
            icon: Phone,
            type: "secondary",
          },
        ],
      };
    }

    // Services
    if (
      lowerQuery.includes("service") ||
      lowerQuery.includes("que faites") ||
      lowerQuery.includes("sp√©cialit√©")
    ) {
      return {
        response: `# üé® Nos Services Experts

**Mind Graphix Solution** est votre partenaire digital complet au Burkina Faso !

## üåê **D√©veloppement Web**
‚Ä¢ **Sites Vitrines** - Pr√©sentation professionnelle de votre activit√©
‚Ä¢ **E-commerce** - Boutiques en ligne avec paiement s√©curis√©
‚Ä¢ **Applications Web** - Solutions sur-mesure pour vos processus
‚Ä¢ **Maintenance & SEO** - Suivi et optimisation continue

## üé® **Design Graphique** 
‚Ä¢ **Identit√© Visuelle** - Logo, charte graphique, branding
‚Ä¢ **Supports Print** - Cartes, brochures, affiches, packaging
‚Ä¢ **Design Digital** - R√©seaux sociaux, banni√®res, newsletters
‚Ä¢ **Illustrations** - Cr√©ations artistiques personnalis√©es

## üìä **Marketing Digital**
‚Ä¢ **Strat√©gie Digitale** - Audit et plan d'action personnalis√©
‚Ä¢ **R√©seaux Sociaux** - Gestion compl√®te de vos comptes
‚Ä¢ **R√©f√©rencement SEO** - Visibilit√© Google optimis√©e
‚Ä¢ **Publicit√© En Ligne** - Campagnes Google Ads & Facebook

## üèÜ **Pourquoi Nous Choisir ?**
‚úÖ **+50 projets** r√©alis√©s avec succ√®s
‚úÖ **3+ ann√©es** d'exp√©rience au Burkina Faso
‚úÖ **100% satisfaction** client garantie
‚úÖ **Support 24/7** et maintenance incluse`,
        category: "service",
        quickReplies: [
          "üåê En savoir plus sur le Web",
          "üé® Plus d'infos Design",
          "üìä Marketing Digital d√©tails",
        ],
        actions: [
          {
            label: "Voir nos R√©alisations",
            action: () => showPortfolio(),
            icon: Star,
            type: "primary",
          },
        ],
      };
    }

    // Contact/rendez-vous
    if (
      lowerQuery.includes("rendez-vous") ||
      lowerQuery.includes("appel") ||
      lowerQuery.includes("contact") ||
      lowerQuery.includes("rencontrer")
    ) {
      return {
        response: `# üìû Prendre Rendez-vous

Parfait ! Nous adorons rencontrer nos futurs clients et discuter de leurs projets.

## üìÖ **Options de Contact :**

**üéØ Consultation Gratuite (30min)**
‚Ä¢ Analyse de vos besoins
‚Ä¢ Conseils personnalis√©s  
‚Ä¢ Estimation de budget
‚Ä¢ Planning projet

**üìû Contact Direct :**
‚Ä¢ **T√©l√©phone :** +226 54191605
‚Ä¢ **WhatsApp :** +226 54191605  
‚Ä¢ **Email :** contact@mindgraphix.com

**üìç Bureau :**
Mind Graphix Solution  
Ouagadougou, Burkina Faso  
(Rendez-vous sur demande)

## ‚è∞ **Disponibilit√©s :**
‚Ä¢ **Lundi - Vendredi :** 8h - 18h
‚Ä¢ **Samedi :** 9h - 15h (sur rendez-vous)
‚Ä¢ **R√©ponse email :** Sous 2h en moyenne

Quel mode de contact pr√©f√©rez-vous ?`,
        category: "contact",
        quickReplies: [
          "üìû Appeler maintenant",
          "üí¨ WhatsApp",
          "üìß Email d√©taill√©",
        ],
        actions: [
          {
            label: "Formulaire Contact",
            action: () => setShowContactForm(true),
            icon: Mail,
            type: "primary",
          },
        ],
      };
    }

    // R√©alisations/portfolio
    if (
      lowerQuery.includes("r√©alisation") ||
      lowerQuery.includes("exemple") ||
      lowerQuery.includes("portfolio") ||
      lowerQuery.includes("travail")
    ) {
      return {
        response: `# üèÜ Nos R√©alisations

D√©couvrez quelques-unes de nos **+50 r√©alisations** qui ont fait la diff√©rence pour nos clients !

## üåê **Sites Web R√©cents :**
‚Ä¢ **E-commerce Textile** - Boutique mode burkinab√© (2024)
‚Ä¢ **Site Corporate** - Entreprise BTP √† Ouagadougou  
‚Ä¢ **Plateforme Formation** - Institut priv√© avec LMS
‚Ä¢ **Site Restaurant** - Cha√Æne locale avec commande en ligne

## üé® **Identit√©s Visuelles :**
‚Ä¢ **Startup Tech** - Logo + Charte compl√®te
‚Ä¢ **ONG Locale** - Branding pour campagne nationale
‚Ä¢ **Boutique Bio** - Packaging produits naturels
‚Ä¢ **Salon de Coiffure** - Supports print + digital

## üìä **Succ√®s Marketing :**
‚Ä¢ **+300% trafic web** pour un e-commerce  
‚Ä¢ **x5 followers** sur r√©seaux sociaux (6 mois)
‚Ä¢ **ROI 450%** sur campagnes Google Ads
‚Ä¢ **-50% co√ªt acquisition** client via SEO

## üéØ **T√©moignages Clients :**
‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê *"Professional et √† l'√©coute ! Notre site a d√©pass√© nos attentes"* - **Aminata S.**

‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê *"Design magnifique et service apr√®s-vente impeccable"* - **Ibrahim T.**

Souhaitez-vous voir des exemples sp√©cifiques √† votre secteur ?`,
        category: "service",
        quickReplies: [
          "üåê Exemples sites web",
          "üé® Portfolio design",
          "üìà Cas marketing",
        ],
      };
    }

    // Question g√©n√©rale
    return {
      response: `# ü§ñ Assistant MindiBot

J'ai bien re√ßu votre message : **"${query}"**

Je suis l√† pour vous aider avec toutes vos questions sur **Mind Graphix Solution** !

## üéØ **Je peux vous renseigner sur :**

**üíº Nos Services**
‚Ä¢ D√©veloppement Web & Applications
‚Ä¢ Design Graphique & Identit√© Visuelle  
‚Ä¢ Marketing Digital & R√©seaux Sociaux

**üí∞ Tarifs & Devis**
‚Ä¢ Estimation gratuite de votre projet
‚Ä¢ Devis d√©taill√© sous 48h
‚Ä¢ Options de paiement flexibles

**üìû Contact & Rendez-vous**
‚Ä¢ Consultation gratuite 30min
‚Ä¢ Rencontre en personne ou visio
‚Ä¢ Support technique continu

**üèÜ Nos R√©alisations**
‚Ä¢ +50 projets r√©ussis
‚Ä¢ T√©moignages clients authentiques
‚Ä¢ Portfolio diversifi√©

Comment puis-je vous aider plus pr√©cis√©ment ?`,
      category: "help",
      quickReplies: [
        "üí∞ Demander un devis",
        "üìû Prendre rendez-vous",
        "üé® Voir vos services",
        "üìã Vos r√©alisations",
      ],
    };
  };

  const handleSendMessage = () => {
    if (!currentMessage.trim()) return;

    addUserMessage(currentMessage);
    const analysis = analyzeClientQuery(currentMessage);
    setCurrentMessage("");

    setTimeout(() => {
      addBotMessage(
        analysis.response,
        analysis.category,
        analysis.quickReplies,
        analysis.actions,
      );
    }, 500);
  };

  const handleQuickReply = (reply: string) => {
    addUserMessage(reply);
    const analysis = analyzeClientQuery(reply);

    setTimeout(() => {
      addBotMessage(
        analysis.response,
        analysis.category,
        analysis.quickReplies,
        analysis.actions,
      );
    }, 800);
  };

  const showServices = () => {
    addBotMessage(
      `# üéØ Services D√©taill√©s

**Choisissez le service qui vous int√©resse :**

üåê **Sites Web & Applications**
‚Ä¢ Sites vitrines professionnels
‚Ä¢ E-commerce cl√© en main
‚Ä¢ Applications m√©tier
‚Ä¢ Maintenance & hosting

üé® **Design & Cr√©ation**  
‚Ä¢ Logo & identit√© visuelle
‚Ä¢ Supports print (cartes, brochures)
‚Ä¢ Design r√©seaux sociaux
‚Ä¢ Packaging & PLV

üìä **Marketing Digital**
‚Ä¢ Strat√©gie digitale compl√®te
‚Ä¢ Gestion r√©seaux sociaux
‚Ä¢ SEO & r√©f√©rencement Google
‚Ä¢ Campagnes publicitaires

Quel service vous int√©resse le plus ?`,
      "service",
      ["üåê Web & Applications", "üé® Design & Cr√©ation", "üìä Marketing Digital"],
    );
  };

  const showContact = () => {
    addBotMessage(
      `# üìû Contactez-nous Directement

**Plusieurs moyens de nous joindre :**

üì± **T√©l√©phone :** +226 54191605  
ÔøΩÔøΩ **Email :** contact@mindgraphix.com  
üí¨ **WhatsApp :** +226 54191605

üìç **Adresse :**  
Mind Graphix Solution  
Ouagadougou, Burkina Faso

‚è∞ **Horaires :**  
Lundi - Vendredi : 8h - 18h  
Samedi : 9h - 15h (sur RDV)

Nous r√©pondons g√©n√©ralement sous 2h !`,
      "contact",
      ["üìû Appeler maintenant", "üìß Envoyer un email", "üí¨ WhatsApp"],
    );
  };

  const showPortfolio = () => {
    addBotMessage(
      `# üèÜ Portfolio Mind Graphix

**Nos R√©alisations par Cat√©gorie :**

üåê **Sites Web (15+ projets)**
‚Ä¢ E-commerce mode & textile
‚Ä¢ Sites corporate & institutionnels  
‚Ä¢ Plateformes √©ducatives
‚Ä¢ Sites restaurants & services

üé® **Identit√©s Visuelles (20+ cr√©ations)**
‚Ä¢ Startups tech burkinab√©s
‚Ä¢ ONGs & associations
‚Ä¢ Commerces locaux
‚Ä¢ √âv√©nements & festivals

üìä **Campagnes Marketing (10+ succ√®s)**
‚Ä¢ +300% trafic e-commerce
‚Ä¢ x5 croissance r√©seaux sociaux
‚Ä¢ ROI 450% Google Ads
‚Ä¢ Strat√©gies SEO gagnantes

Souhaitez-vous voir des exemples sp√©cifiques ?`,
      "service",
      ["üåê Sites web", "üé® Design", "üìä Marketing", "üìû Discuter projet"],
    );
  };

  const getCategoryIcon = (category?: ClientMessage["category"]) => {
    switch (category) {
      case "info":
        return <Info className="text-blue-500" size={16} />;
      case "service":
        return <Package className="text-purple-500" size={16} />;
      case "contact":
        return <Phone className="text-green-500" size={16} />;
      case "help":
        return <HelpCircle className="text-orange-500" size={16} />;
      case "pricing":
        return <CreditCard className="text-red-500" size={16} />;
      default:
        return <Bot className="text-gray-500" size={16} />;
    }
  };

  const getCategoryColor = (category?: ClientMessage["category"]) => {
    switch (category) {
      case "info":
        return "border-blue-200 bg-blue-50";
      case "service":
        return "border-purple-200 bg-purple-50";
      case "contact":
        return "border-green-200 bg-green-50";
      case "help":
        return "border-orange-200 bg-orange-50";
      case "pricing":
        return "border-red-200 bg-red-50";
      default:
        return "border-gray-200 bg-gray-50";
    }
  };

  // MindiBot s'affiche pour tous les utilisateurs

  return (
    <>
      {/* Bouton flottant MindiBot */}
      <motion.div
        className="fixed bottom-6 right-6 z-50"
        initial={{ opacity: 0, y: 50 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.8, type: "spring", stiffness: 300 }}
      >
        <motion.button
          onClick={() => setIsOpen(true)}
          className="group relative overflow-hidden bg-gradient-to-br from-purple-500 via-pink-500 to-red-500 hover:from-purple-400 hover:via-pink-400 hover:to-red-400 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 border border-white/20 backdrop-blur-sm"
          whileHover={{ scale: 1.02, y: -2 }}
          whileTap={{ scale: 0.98 }}
          title="MindiBot - Assistant Client"
        >
          {/* Effet glassmorphism */}
          <div className="absolute inset-0 bg-gradient-to-br from-white/10 to-transparent rounded-full"></div>

          {/* Contenu principal - Version boule */}
          <div className="relative w-16 h-16 flex items-center justify-center">
            <div className="relative">
              <MessageCircle
                size={24}
                className="group-hover:scale-110 transition-transform duration-300"
              />
              <motion.div
                className="absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full"
                animate={{ scale: [1, 1.3, 1], opacity: [0.8, 1, 0.8] }}
                transition={{ duration: 2, repeat: Infinity }}
              />
            </div>
          </div>

          {/* Effet hover shine */}
          <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700 ease-out"></div>
        </motion.button>
      </motion.div>

      {/* Interface MindiBot */}
      <AnimatePresence>
        {isOpen && (
          <motion.div
            className="fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
            onClick={() => setIsOpen(false)}
          >
            <motion.div
              className="bg-white rounded-2xl shadow-2xl border border-gray-200 w-full max-w-4xl max-h-[90vh] m-4 overflow-hidden"
              initial={{ scale: 0.9, opacity: 0, y: 20 }}
              animate={{ scale: 1, opacity: 1, y: 0 }}
              exit={{ scale: 0.9, opacity: 0, y: 20 }}
              onClick={(e) => e.stopPropagation()}
            >
              {/* Header */}
              <div className="bg-gradient-to-r from-emerald-500 to-blue-500 p-6 text-white">
                <div className="flex items-center justify-between">
                  <div className="flex items-center space-x-4">
                    <div className="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm">
                      <MessageCircle size={24} />
                    </div>
                    <div>
                      <h2 className="text-2xl font-bold flex items-center space-x-2">
                        <span>MindiBot</span>
                        <span className="text-lg">ü§ñ</span>
                      </h2>
                      <p className="text-emerald-100">
                        Assistant Client Mind Graphix Solution
                      </p>
                    </div>
                  </div>
                  <div className="flex items-center space-x-3">
                    <div className="text-right">
                      <div className="text-sm opacity-90">Burkina Faso üáßüá´</div>
                      <div className="text-xs opacity-75 flex items-center space-x-1">
                        <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        <span>En ligne</span>
                      </div>
                    </div>
                    <Button
                      onClick={() => setIsOpen(false)}
                      variant="ghost"
                      className="text-white hover:bg-white/10"
                    >
                      <X size={24} />
                    </Button>
                  </div>
                </div>
              </div>

              {/* Messages */}
              <div className="p-6 max-h-[60vh] overflow-y-auto">
                <div className="space-y-4">
                  {messages.map((message, index) => (
                    <motion.div
                      key={message.id}
                      initial={{ opacity: 0, y: 20 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: index * 0.1 }}
                      className={`flex ${message.type === "user" ? "justify-end" : "justify-start"}`}
                    >
                      <div
                        className={`max-w-3xl p-4 rounded-2xl ${
                          message.type === "user"
                            ? "bg-gradient-to-r from-emerald-500 to-blue-500 text-white"
                            : `${getCategoryColor(message.category)} border`
                        }`}
                      >
                        <div className="flex items-start space-x-3">
                          {message.type === "bot" && (
                            <div className="flex-shrink-0 mt-1">
                              {getCategoryIcon(message.category)}
                            </div>
                          )}
                          <div className="flex-1">
                            <div className="prose prose-sm max-w-none">
                              <div className="whitespace-pre-wrap leading-relaxed">
                                {message.content}
                              </div>
                            </div>

                            {message.quickReplies &&
                              message.quickReplies.length > 0 && (
                                <div className="mt-3 flex flex-wrap gap-2">
                                  {message.quickReplies.map((reply, idx) => (
                                    <button
                                      key={idx}
                                      onClick={() => handleQuickReply(reply)}
                                      className="px-3 py-1 text-sm bg-emerald-100 hover:bg-emerald-200 text-emerald-800 rounded-full transition-colors"
                                    >
                                      {reply}
                                    </button>
                                  ))}
                                </div>
                              )}

                            {message.actions && message.actions.length > 0 && (
                              <div className="mt-4 flex flex-wrap gap-2">
                                {message.actions.map((action, idx) => (
                                  <Button
                                    key={idx}
                                    onClick={action.action}
                                    variant={
                                      action.type === "primary"
                                        ? "default"
                                        : "outline"
                                    }
                                    size="sm"
                                    className={`text-xs ${
                                      action.type === "primary"
                                        ? "bg-emerald-600 hover:bg-emerald-700 text-white"
                                        : ""
                                    }`}
                                  >
                                    {action.icon && (
                                      <action.icon size={14} className="mr-1" />
                                    )}
                                    {action.label}
                                  </Button>
                                ))}
                              </div>
                            )}
                          </div>
                          {message.type === "user" && (
                            <div className="flex-shrink-0 mt-1">
                              <User size={16} className="text-white/80" />
                            </div>
                          )}
                        </div>
                      </div>
                    </motion.div>
                  ))}

                  {isTyping && (
                    <motion.div
                      initial={{ opacity: 0, y: 20 }}
                      animate={{ opacity: 1, y: 0 }}
                      className="flex justify-start"
                    >
                      <div className="bg-gray-100 border border-gray-200 p-4 rounded-2xl">
                        <div className="flex items-center space-x-3">
                          <motion.div
                            animate={{ rotate: 360 }}
                            transition={{
                              duration: 2,
                              repeat: Infinity,
                              ease: "linear",
                            }}
                          >
                            <Bot size={16} className="text-emerald-600" />
                          </motion.div>
                          <div className="text-gray-600">MindiBot tape...</div>
                        </div>
                      </div>
                    </motion.div>
                  )}
                </div>
                <div ref={messagesEndRef} />
              </div>

              {/* Input */}
              <div className="border-t border-gray-200 p-6">
                <div className="flex items-center space-x-4">
                  <div className="flex-1 relative">
                    <input
                      type="text"
                      value={currentMessage}
                      onChange={(e) => setCurrentMessage(e.target.value)}
                      onKeyPress={(e) =>
                        e.key === "Enter" && handleSendMessage()
                      }
                      placeholder="Posez votre question √† MindiBot..."
                      className="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent pr-12"
                      disabled={isTyping}
                    />
                    <div className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400">
                      <MessageCircle size={16} />
                    </div>
                  </div>
                  <Button
                    onClick={handleSendMessage}
                    disabled={!currentMessage.trim() || isTyping}
                    className="bg-gradient-to-r from-emerald-500 to-blue-500 hover:from-emerald-600 hover:to-blue-600 text-white px-6 py-3"
                  >
                    <Send size={18} />
                  </Button>
                </div>

                <div className="mt-3 flex items-center justify-between text-xs text-gray-500">
                  <div className="flex items-center space-x-4">
                    <span>MindiBot v1.0 - Mind Graphix Solution</span>
                    <span>‚Ä¢</span>
                    <span>Assistant Client Intelligent</span>
                    <span>‚Ä¢</span>
                    <span>Burkina Faso üáßüá´</span>
                  </div>
                  <div className="flex items-center space-x-2">
                    <div className="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span>Disponible 24/7</span>
                  </div>
                </div>
              </div>
            </motion.div>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Formulaire de contact modal */}
      {showContactForm && (
        <motion.div
          className="fixed inset-0 z-60 flex items-center justify-center bg-black/60 backdrop-blur-sm"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          onClick={() => setShowContactForm(false)}
        >
          <motion.div
            className="bg-white rounded-xl p-6 max-w-md w-full m-4"
            initial={{ scale: 0.9, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            onClick={(e) => e.stopPropagation()}
          >
            <h3 className="text-xl font-bold mb-4">üìû Demande de Contact</h3>
            <div className="space-y-3 text-sm">
              <p>
                <strong>T√©l√©phone :</strong> +226 54191605
              </p>
              <p>
                <strong>Email :</strong> contact@mindgraphix.com
              </p>
              <p>
                <strong>WhatsApp :</strong> +226 54191605
              </p>
              <p className="text-gray-600">
                Nous vous recontacterons sous 2h !
              </p>
            </div>
            <Button
              onClick={() => setShowContactForm(false)}
              className="w-full mt-4 bg-emerald-600 hover:bg-emerald-700"
            >
              Compris !
            </Button>
          </motion.div>
        </motion.div>
      )}
    </>
  );
};

export default ClientAssistantBot;
